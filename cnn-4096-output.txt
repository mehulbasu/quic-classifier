/mydata/740-project/scripts/train_pytorch.py:595: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  payload = torch.load(chunk_path, map_location="cpu")
Epoch 0 Chunk 3 Step 0: loss=4.7391 acc=0.0076
Epoch 0 Chunk 3 Step 250: loss=4.2761 acc=0.0968
Epoch 0 Chunk 3 Step 500: loss=3.8775 acc=0.1528
Epoch 0 Chunk 3 Step 750: loss=3.5910 acc=0.2059
Epoch 0 Chunk 3 Step 1000: loss=3.3754 acc=0.2479
Epoch 0 Chunk 3 Step 1250: loss=3.2043 acc=0.2810
Epoch 0 Chunk 3 Step 1500: loss=3.0647 acc=0.3076
Epoch 0 Chunk 3 Step 1750: loss=2.9476 acc=0.3301
Epoch 0 Chunk 1 Step 0: loss=2.1546 acc=0.4829
Epoch 0 Chunk 1 Step 250: loss=2.1243 acc=0.4891
Epoch 0 Chunk 1 Step 500: loss=2.0882 acc=0.4980
Epoch 0 Chunk 1 Step 750: loss=2.0550 acc=0.5063
Epoch 0 Chunk 1 Step 1000: loss=2.0263 acc=0.5136
Epoch 0 Chunk 1 Step 1250: loss=1.9998 acc=0.5206
Epoch 0 Chunk 1 Step 1500: loss=1.9752 acc=0.5273
Epoch 0 Chunk 1 Step 1750: loss=1.9525 acc=0.5335
Epoch 0 Chunk 1 Step 2000: loss=1.9313 acc=0.5394
Epoch 0 Chunk 2 Step 0: loss=1.7320 acc=0.5916
Epoch 0 Chunk 2 Step 250: loss=1.7422 acc=0.5924
Epoch 0 Chunk 2 Step 500: loss=1.7299 acc=0.5960
Epoch 0 Chunk 2 Step 750: loss=1.7171 acc=0.6001
Epoch 0 Chunk 2 Step 1000: loss=1.7056 acc=0.6037
Epoch 0 Chunk 2 Step 1250: loss=1.6942 acc=0.6072
Epoch 0 Chunk 2 Step 1500: loss=1.6836 acc=0.6104
Epoch 0 Chunk 2 Step 1750: loss=1.6735 acc=0.6135
Epoch 0 Chunk 2 Step 2000: loss=1.6638 acc=0.6165
Epoch 0 Chunk 4 Step 0: loss=1.5944 acc=0.6489
Epoch 0 Chunk 4 Step 250: loss=1.5705 acc=0.6471
Epoch 0 Chunk 4 Step 500: loss=1.5628 acc=0.6496
Epoch 0 Chunk 4 Step 750: loss=1.5551 acc=0.6520
Epoch 0 Chunk 4 Step 1000: loss=1.5476 acc=0.6543
Epoch 0 Chunk 4 Step 1250: loss=1.5410 acc=0.6561
Epoch 0 Chunk 0 Step 0: loss=1.5332 acc=0.6565
Epoch 0 Chunk 0 Step 250: loss=1.5224 acc=0.6601
Epoch 0 Chunk 0 Step 500: loss=1.5155 acc=0.6620
Epoch 0 Chunk 0 Step 750: loss=1.5098 acc=0.6636
Epoch 0 Chunk 0 Step 1000: loss=1.5047 acc=0.6653
Epoch 0 Chunk 0 Step 1250: loss=1.4993 acc=0.6669
Epoch 0 Chunk 0 Step 1500: loss=1.4943 acc=0.6684
Epoch 0 Chunk 0 Step 1750: loss=1.4897 acc=0.6699
Epoch 0 Chunk 0 Step 2000: loss=1.4850 acc=0.6712
Epoch 0 Chunk 5 Step 0: loss=1.3599 acc=0.7139
Epoch 0 Chunk 5 Step 250: loss=1.3471 acc=0.7202
Epoch 0 Chunk 5 Step 500: loss=1.3391 acc=0.7228
Epoch 0 | train_loss=1.8750 train_acc=0.5723 | val_loss=1.2561 val_acc=0.7464 val_macro_f1=0.3852
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 1 Chunk 5 Step 0: loss=1.3317 acc=0.7271
Epoch 1 Chunk 5 Step 250: loss=1.3088 acc=0.7321
Epoch 1 Chunk 5 Step 500: loss=1.2969 acc=0.7356
Epoch 1 Chunk 4 Step 0: loss=1.3805 acc=0.7090
Epoch 1 Chunk 4 Step 250: loss=1.3593 acc=0.7108
Epoch 1 Chunk 4 Step 500: loss=1.3492 acc=0.7136
Epoch 1 Chunk 4 Step 750: loss=1.3409 acc=0.7160
Epoch 1 Chunk 4 Step 1000: loss=1.3335 acc=0.7183
Epoch 1 Chunk 4 Step 1250: loss=1.3261 acc=0.7205
Epoch 1 Chunk 3 Step 0: loss=1.2939 acc=0.7300
Epoch 1 Chunk 3 Step 250: loss=1.2874 acc=0.7321
Epoch 1 Chunk 3 Step 500: loss=1.2813 acc=0.7336
Epoch 1 Chunk 3 Step 750: loss=1.2758 acc=0.7355
Epoch 1 Chunk 3 Step 1000: loss=1.2706 acc=0.7372
Epoch 1 Chunk 3 Step 1250: loss=1.2658 acc=0.7387
Epoch 1 Chunk 3 Step 1500: loss=1.2610 acc=0.7402
Epoch 1 Chunk 3 Step 1750: loss=1.2563 acc=0.7416
Epoch 1 Chunk 1 Step 0: loss=1.2464 acc=0.7395
Epoch 1 Chunk 1 Step 250: loss=1.2361 acc=0.7466
Epoch 1 Chunk 1 Step 500: loss=1.2317 acc=0.7482
Epoch 1 Chunk 1 Step 750: loss=1.2289 acc=0.7490
Epoch 1 Chunk 1 Step 1000: loss=1.2253 acc=0.7501
Epoch 1 Chunk 1 Step 1250: loss=1.2218 acc=0.7512
Epoch 1 Chunk 1 Step 1500: loss=1.2186 acc=0.7522
Epoch 1 Chunk 1 Step 1750: loss=1.2155 acc=0.7532
Epoch 1 Chunk 1 Step 2000: loss=1.2126 acc=0.7541
Epoch 1 Chunk 2 Step 0: loss=1.1783 acc=0.7637
Epoch 1 Chunk 2 Step 250: loss=1.1839 acc=0.7642
Epoch 1 Chunk 2 Step 500: loss=1.1827 acc=0.7642
Epoch 1 Chunk 2 Step 750: loss=1.1801 acc=0.7650
Epoch 1 Chunk 2 Step 1000: loss=1.1778 acc=0.7657
Epoch 1 Chunk 2 Step 1250: loss=1.1752 acc=0.7665
Epoch 1 Chunk 2 Step 1500: loss=1.1728 acc=0.7671
Epoch 1 Chunk 2 Step 1750: loss=1.1707 acc=0.7678
Epoch 1 Chunk 2 Step 2000: loss=1.1685 acc=0.7685
Epoch 1 Chunk 0 Step 0: loss=1.1606 acc=0.7742
Epoch 1 Chunk 0 Step 250: loss=1.1585 acc=0.7708
Epoch 1 Chunk 0 Step 500: loss=1.1561 acc=0.7715
Epoch 1 Chunk 0 Step 750: loss=1.1547 acc=0.7720
Epoch 1 Chunk 0 Step 1000: loss=1.1523 acc=0.7729
Epoch 1 Chunk 0 Step 1250: loss=1.1505 acc=0.7735
Epoch 1 Chunk 0 Step 1500: loss=1.1484 acc=0.7741
Epoch 1 Chunk 0 Step 1750: loss=1.1468 acc=0.7746
Epoch 1 Chunk 0 Step 2000: loss=1.1453 acc=0.7751
Epoch 1 | train_loss=1.2170 train_acc=0.7538 | val_loss=1.0101 val_acc=0.8202 val_macro_f1=0.5191
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 2 Chunk 2 Step 0: loss=1.1151 acc=0.7778
Epoch 2 Chunk 2 Step 250: loss=1.1247 acc=0.7826
Epoch 2 Chunk 2 Step 500: loss=1.1208 acc=0.7836
Epoch 2 Chunk 2 Step 750: loss=1.1187 acc=0.7842
Epoch 2 Chunk 2 Step 1000: loss=1.1158 acc=0.7852
Epoch 2 Chunk 2 Step 1250: loss=1.1133 acc=0.7859
Epoch 2 Chunk 2 Step 1500: loss=1.1107 acc=0.7867
Epoch 2 Chunk 2 Step 1750: loss=1.1086 acc=0.7874
Epoch 2 Chunk 2 Step 2000: loss=1.1063 acc=0.7882
Epoch 2 Chunk 1 Step 0: loss=1.0705 acc=0.8044
Epoch 2 Chunk 1 Step 250: loss=1.0889 acc=0.7929
Epoch 2 Chunk 1 Step 500: loss=1.0870 acc=0.7938
Epoch 2 Chunk 1 Step 750: loss=1.0855 acc=0.7943
Epoch 2 Chunk 1 Step 1000: loss=1.0835 acc=0.7950
Epoch 2 Chunk 1 Step 1250: loss=1.0816 acc=0.7957
Epoch 2 Chunk 1 Step 1500: loss=1.0796 acc=0.7963
Epoch 2 Chunk 1 Step 1750: loss=1.0781 acc=0.7968
Epoch 2 Chunk 1 Step 2000: loss=1.0764 acc=0.7974
Epoch 2 Chunk 5 Step 0: loss=0.9672 acc=0.8467
Epoch 2 Chunk 5 Step 250: loss=0.9831 acc=0.8311
Epoch 2 Chunk 5 Step 500: loss=0.9788 acc=0.8322
Epoch 2 Chunk 0 Step 0: loss=1.0998 acc=0.7876
Epoch 2 Chunk 0 Step 250: loss=1.0654 acc=0.8012
Epoch 2 Chunk 0 Step 500: loss=1.0635 acc=0.8017
Epoch 2 Chunk 0 Step 750: loss=1.0614 acc=0.8023
Epoch 2 Chunk 0 Step 1000: loss=1.0593 acc=0.8030
Epoch 2 Chunk 0 Step 1250: loss=1.0576 acc=0.8035
Epoch 2 Chunk 0 Step 1500: loss=1.0558 acc=0.8041
Epoch 2 Chunk 0 Step 1750: loss=1.0540 acc=0.8047
Epoch 2 Chunk 0 Step 2000: loss=1.0526 acc=0.8051
Epoch 2 Chunk 4 Step 0: loss=1.0436 acc=0.8083
Epoch 2 Chunk 4 Step 250: loss=1.0229 acc=0.8147
Epoch 2 Chunk 4 Step 500: loss=1.0201 acc=0.8158
Epoch 2 Chunk 4 Step 750: loss=1.0192 acc=0.8163
Epoch 2 Chunk 4 Step 1000: loss=1.0179 acc=0.8167
Epoch 2 Chunk 4 Step 1250: loss=1.0167 acc=0.8171
Epoch 2 Chunk 3 Step 0: loss=1.0110 acc=0.8132
Epoch 2 Chunk 3 Step 250: loss=1.0123 acc=0.8189
Epoch 2 Chunk 3 Step 500: loss=1.0124 acc=0.8187
Epoch 2 Chunk 3 Step 750: loss=1.0106 acc=0.8193
Epoch 2 Chunk 3 Step 1000: loss=1.0095 acc=0.8196
Epoch 2 Chunk 3 Step 1250: loss=1.0081 acc=0.8201
Epoch 2 Chunk 3 Step 1500: loss=1.0070 acc=0.8204
Epoch 2 Chunk 3 Step 1750: loss=1.0058 acc=0.8207
Epoch 2 | train_loss=1.0501 train_acc=0.8063 | val_loss=0.9136 val_acc=0.8502 val_macro_f1=0.5989
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 3 Chunk 5 Step 0: loss=0.9722 acc=0.8274
Epoch 3 Chunk 5 Step 250: loss=0.9324 acc=0.8472
Epoch 3 Chunk 5 Step 500: loss=0.9277 acc=0.8485
Epoch 3 Chunk 0 Step 0: loss=1.0219 acc=0.8079
Epoch 3 Chunk 0 Step 250: loss=1.0168 acc=0.8163
Epoch 3 Chunk 0 Step 500: loss=1.0134 acc=0.8173
Epoch 3 Chunk 0 Step 750: loss=1.0113 acc=0.8181
Epoch 3 Chunk 0 Step 1000: loss=1.0094 acc=0.8188
Epoch 3 Chunk 0 Step 1250: loss=1.0077 acc=0.8194
Epoch 3 Chunk 0 Step 1500: loss=1.0063 acc=0.8199
Epoch 3 Chunk 0 Step 1750: loss=1.0046 acc=0.8204
Epoch 3 Chunk 0 Step 2000: loss=1.0033 acc=0.8209
Epoch 3 Chunk 1 Step 0: loss=0.9858 acc=0.8254
Epoch 3 Chunk 1 Step 250: loss=0.9895 acc=0.8252
Epoch 3 Chunk 1 Step 500: loss=0.9873 acc=0.8261
Epoch 3 Chunk 1 Step 750: loss=0.9862 acc=0.8265
Epoch 3 Chunk 1 Step 1000: loss=0.9849 acc=0.8269
Epoch 3 Chunk 1 Step 1250: loss=0.9838 acc=0.8273
Epoch 3 Chunk 1 Step 1500: loss=0.9830 acc=0.8275
Epoch 3 Chunk 1 Step 1750: loss=0.9820 acc=0.8279
Epoch 3 Chunk 1 Step 2000: loss=0.9811 acc=0.8282
Epoch 3 Chunk 4 Step 0: loss=0.9630 acc=0.8328
Epoch 3 Chunk 4 Step 250: loss=0.9599 acc=0.8350
Epoch 3 Chunk 4 Step 500: loss=0.9592 acc=0.8352
Epoch 3 Chunk 4 Step 750: loss=0.9581 acc=0.8357
Epoch 3 Chunk 4 Step 1000: loss=0.9565 acc=0.8363
Epoch 3 Chunk 4 Step 1250: loss=0.9552 acc=0.8367
Epoch 3 Chunk 3 Step 0: loss=0.9541 acc=0.8386
Epoch 3 Chunk 3 Step 250: loss=0.9545 acc=0.8368
Epoch 3 Chunk 3 Step 500: loss=0.9525 acc=0.8375
Epoch 3 Chunk 3 Step 750: loss=0.9517 acc=0.8379
Epoch 3 Chunk 3 Step 1000: loss=0.9506 acc=0.8384
Epoch 3 Chunk 3 Step 1250: loss=0.9498 acc=0.8386
Epoch 3 Chunk 3 Step 1500: loss=0.9489 acc=0.8389
Epoch 3 Chunk 3 Step 1750: loss=0.9480 acc=0.8392
Epoch 3 Chunk 2 Step 0: loss=0.9504 acc=0.8391
Epoch 3 Chunk 2 Step 250: loss=0.9529 acc=0.8377
Epoch 3 Chunk 2 Step 500: loss=0.9523 acc=0.8378
Epoch 3 Chunk 2 Step 750: loss=0.9516 acc=0.8382
Epoch 3 Chunk 2 Step 1000: loss=0.9512 acc=0.8383
Epoch 3 Chunk 2 Step 1250: loss=0.9504 acc=0.8386
Epoch 3 Chunk 2 Step 1500: loss=0.9494 acc=0.8388
Epoch 3 Chunk 2 Step 1750: loss=0.9487 acc=0.8391
Epoch 3 Chunk 2 Step 2000: loss=0.9478 acc=0.8393
/mydata/conda-envs/pytorch/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 3 | train_loss=0.9654 train_acc=0.8336 | val_loss=0.8465 val_acc=0.8715 val_macro_f1=0.6487
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 4 Chunk 1 Step 0: loss=0.9278 acc=0.8430
Epoch 4 Chunk 1 Step 250: loss=0.9448 acc=0.8403
Epoch 4 Chunk 1 Step 500: loss=0.9435 acc=0.8407
Epoch 4 Chunk 1 Step 750: loss=0.9430 acc=0.8407
Epoch 4 Chunk 1 Step 1000: loss=0.9418 acc=0.8410
Epoch 4 Chunk 1 Step 1250: loss=0.9409 acc=0.8412
Epoch 4 Chunk 1 Step 1500: loss=0.9400 acc=0.8416
Epoch 4 Chunk 1 Step 1750: loss=0.9392 acc=0.8419
Epoch 4 Chunk 1 Step 2000: loss=0.9382 acc=0.8422
Epoch 4 Chunk 4 Step 0: loss=0.9389 acc=0.8435
Epoch 4 Chunk 4 Step 250: loss=0.9184 acc=0.8488
Epoch 4 Chunk 4 Step 500: loss=0.9180 acc=0.8488
Epoch 4 Chunk 4 Step 750: loss=0.9170 acc=0.8493
Epoch 4 Chunk 4 Step 1000: loss=0.9160 acc=0.8496
Epoch 4 Chunk 4 Step 1250: loss=0.9147 acc=0.8501
Epoch 4 Chunk 2 Step 0: loss=0.9620 acc=0.8330
Epoch 4 Chunk 2 Step 250: loss=0.9245 acc=0.8472
Epoch 4 Chunk 2 Step 500: loss=0.9236 acc=0.8474
Epoch 4 Chunk 2 Step 750: loss=0.9230 acc=0.8475
Epoch 4 Chunk 2 Step 1000: loss=0.9220 acc=0.8478
Epoch 4 Chunk 2 Step 1250: loss=0.9215 acc=0.8480
Epoch 4 Chunk 2 Step 1500: loss=0.9208 acc=0.8482
Epoch 4 Chunk 2 Step 1750: loss=0.9203 acc=0.8483
Epoch 4 Chunk 2 Step 2000: loss=0.9196 acc=0.8485
Epoch 4 Chunk 5 Step 0: loss=0.8609 acc=0.8665
Epoch 4 Chunk 5 Step 250: loss=0.8475 acc=0.8741
Epoch 4 Chunk 5 Step 500: loss=0.8454 acc=0.8749
Epoch 4 Chunk 3 Step 0: loss=0.9092 acc=0.8508
Epoch 4 Chunk 3 Step 250: loss=0.9050 acc=0.8537
Epoch 4 Chunk 3 Step 500: loss=0.9033 acc=0.8542
Epoch 4 Chunk 3 Step 750: loss=0.9023 acc=0.8543
Epoch 4 Chunk 3 Step 1000: loss=0.9013 acc=0.8547
Epoch 4 Chunk 3 Step 1250: loss=0.9004 acc=0.8550
Epoch 4 Chunk 3 Step 1500: loss=0.8999 acc=0.8551
Epoch 4 Chunk 3 Step 1750: loss=0.8992 acc=0.8554
Epoch 4 Chunk 0 Step 0: loss=0.8956 acc=0.8572
Epoch 4 Chunk 0 Step 250: loss=0.9131 acc=0.8504
Epoch 4 Chunk 0 Step 500: loss=0.9127 acc=0.8504
Epoch 4 Chunk 0 Step 750: loss=0.9116 acc=0.8509
Epoch 4 Chunk 0 Step 1000: loss=0.9104 acc=0.8514
Epoch 4 Chunk 0 Step 1250: loss=0.9105 acc=0.8512
Epoch 4 Chunk 0 Step 1500: loss=0.9097 acc=0.8514
Epoch 4 Chunk 0 Step 1750: loss=0.9090 acc=0.8517
Epoch 4 Chunk 0 Step 2000: loss=0.9083 acc=0.8520
Epoch 4 | train_loss=0.9121 train_acc=0.8511 | val_loss=0.8089 val_acc=0.8838 val_macro_f1=0.6870
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 5 Chunk 4 Step 0: loss=0.8942 acc=0.8557
Epoch 5 Chunk 4 Step 250: loss=0.8850 acc=0.8600
Epoch 5 Chunk 4 Step 500: loss=0.8831 acc=0.8606
Epoch 5 Chunk 4 Step 750: loss=0.8827 acc=0.8606
Epoch 5 Chunk 4 Step 1000: loss=0.8821 acc=0.8608
Epoch 5 Chunk 4 Step 1250: loss=0.8819 acc=0.8608
Epoch 5 Chunk 1 Step 0: loss=0.8783 acc=0.8594
Epoch 5 Chunk 1 Step 250: loss=0.8969 acc=0.8556
Epoch 5 Chunk 1 Step 500: loss=0.8967 acc=0.8557
Epoch 5 Chunk 1 Step 750: loss=0.8951 acc=0.8563
Epoch 5 Chunk 1 Step 1000: loss=0.8941 acc=0.8568
Epoch 5 Chunk 1 Step 1250: loss=0.8938 acc=0.8568
Epoch 5 Chunk 1 Step 1500: loss=0.8931 acc=0.8571
Epoch 5 Chunk 1 Step 1750: loss=0.8924 acc=0.8573
Epoch 5 Chunk 1 Step 2000: loss=0.8922 acc=0.8574
Epoch 5 Chunk 5 Step 0: loss=0.8378 acc=0.8723
Epoch 5 Chunk 5 Step 250: loss=0.8224 acc=0.8828
Epoch 5 Chunk 5 Step 500: loss=0.8197 acc=0.8835
Epoch 5 Chunk 3 Step 0: loss=0.8902 acc=0.8582
Epoch 5 Chunk 3 Step 250: loss=0.8802 acc=0.8609
Epoch 5 Chunk 3 Step 500: loss=0.8782 acc=0.8618
Epoch 5 Chunk 3 Step 750: loss=0.8768 acc=0.8623
Epoch 5 Chunk 3 Step 1000: loss=0.8769 acc=0.8622
Epoch 5 Chunk 3 Step 1250: loss=0.8760 acc=0.8626
Epoch 5 Chunk 3 Step 1500: loss=0.8753 acc=0.8629
Epoch 5 Chunk 3 Step 1750: loss=0.8744 acc=0.8632
Epoch 5 Chunk 0 Step 0: loss=0.8849 acc=0.8586
Epoch 5 Chunk 0 Step 250: loss=0.8872 acc=0.8589
Epoch 5 Chunk 0 Step 500: loss=0.8870 acc=0.8590
Epoch 5 Chunk 0 Step 750: loss=0.8854 acc=0.8597
Epoch 5 Chunk 0 Step 1000: loss=0.8851 acc=0.8597
Epoch 5 Chunk 0 Step 1250: loss=0.8844 acc=0.8600
Epoch 5 Chunk 0 Step 1500: loss=0.8839 acc=0.8602
Epoch 5 Chunk 0 Step 1750: loss=0.8834 acc=0.8604
Epoch 5 Chunk 0 Step 2000: loss=0.8827 acc=0.8606
Epoch 5 Chunk 2 Step 0: loss=0.9083 acc=0.8481
Epoch 5 Chunk 2 Step 250: loss=0.8753 acc=0.8629
Epoch 5 Chunk 2 Step 500: loss=0.8747 acc=0.8631
Epoch 5 Chunk 2 Step 750: loss=0.8737 acc=0.8635
Epoch 5 Chunk 2 Step 1000: loss=0.8737 acc=0.8634
Epoch 5 Chunk 2 Step 1250: loss=0.8729 acc=0.8638
Epoch 5 Chunk 2 Step 1500: loss=0.8732 acc=0.8637
Epoch 5 Chunk 2 Step 1750: loss=0.8734 acc=0.8636
Epoch 5 Chunk 2 Step 2000: loss=0.8731 acc=0.8637
Epoch 5 | train_loss=0.8770 train_acc=0.8625 | val_loss=0.7831 val_acc=0.8928 val_macro_f1=0.7076
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 6 Chunk 0 Step 0: loss=0.8758 acc=0.8606
Epoch 6 Chunk 0 Step 250: loss=0.8757 acc=0.8627
Epoch 6 Chunk 0 Step 500: loss=0.8739 acc=0.8633
Epoch 6 Chunk 0 Step 750: loss=0.8741 acc=0.8632
Epoch 6 Chunk 0 Step 1000: loss=0.8746 acc=0.8630
Epoch 6 Chunk 0 Step 1250: loss=0.8738 acc=0.8633
Epoch 6 Chunk 0 Step 1500: loss=0.8739 acc=0.8633
Epoch 6 Chunk 0 Step 1750: loss=0.8735 acc=0.8634
Epoch 6 Chunk 0 Step 2000: loss=0.8729 acc=0.8636
Epoch 6 Chunk 3 Step 0: loss=0.8558 acc=0.8699
Epoch 6 Chunk 3 Step 250: loss=0.8584 acc=0.8686
Epoch 6 Chunk 3 Step 500: loss=0.8570 acc=0.8692
Epoch 6 Chunk 3 Step 750: loss=0.8558 acc=0.8696
Epoch 6 Chunk 3 Step 1000: loss=0.8556 acc=0.8696
Epoch 6 Chunk 3 Step 1250: loss=0.8554 acc=0.8697
Epoch 6 Chunk 3 Step 1500: loss=0.8551 acc=0.8698
Epoch 6 Chunk 3 Step 1750: loss=0.8551 acc=0.8698
Epoch 6 Chunk 5 Step 0: loss=0.8532 acc=0.8726
Epoch 6 Chunk 5 Step 250: loss=0.7993 acc=0.8899
Epoch 6 Chunk 5 Step 500: loss=0.7978 acc=0.8904
Epoch 6 Chunk 1 Step 0: loss=0.8774 acc=0.8616
Epoch 6 Chunk 1 Step 250: loss=0.8639 acc=0.8672
Epoch 6 Chunk 1 Step 500: loss=0.8634 acc=0.8671
Epoch 6 Chunk 1 Step 750: loss=0.8630 acc=0.8671
Epoch 6 Chunk 1 Step 1000: loss=0.8625 acc=0.8672
Epoch 6 Chunk 1 Step 1250: loss=0.8618 acc=0.8675
Epoch 6 Chunk 1 Step 1500: loss=0.8613 acc=0.8676
Epoch 6 Chunk 1 Step 1750: loss=0.8614 acc=0.8676
Epoch 6 Chunk 1 Step 2000: loss=0.8611 acc=0.8677
Epoch 6 Chunk 2 Step 0: loss=0.8784 acc=0.8623
Epoch 6 Chunk 2 Step 250: loss=0.8554 acc=0.8702
Epoch 6 Chunk 2 Step 500: loss=0.8559 acc=0.8696
Epoch 6 Chunk 2 Step 750: loss=0.8554 acc=0.8697
Epoch 6 Chunk 2 Step 1000: loss=0.8567 acc=0.8691
Epoch 6 Chunk 2 Step 1250: loss=0.8567 acc=0.8690
Epoch 6 Chunk 2 Step 1500: loss=0.8566 acc=0.8691
Epoch 6 Chunk 2 Step 1750: loss=0.8561 acc=0.8693
Epoch 6 Chunk 2 Step 2000: loss=0.8558 acc=0.8693
Epoch 6 Chunk 4 Step 0: loss=0.8693 acc=0.8630
Epoch 6 Chunk 4 Step 250: loss=0.8433 acc=0.8731
Epoch 6 Chunk 4 Step 500: loss=0.8436 acc=0.8732
Epoch 6 Chunk 4 Step 750: loss=0.8431 acc=0.8734
Epoch 6 Chunk 4 Step 1000: loss=0.8421 acc=0.8737
Epoch 6 Chunk 4 Step 1250: loss=0.8422 acc=0.8736
Epoch 6 | train_loss=0.8547 train_acc=0.8698 | val_loss=0.7708 val_acc=0.8934 val_macro_f1=0.7165
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 7 Chunk 4 Step 0: loss=0.8403 acc=0.8777
Epoch 7 Chunk 4 Step 250: loss=0.8345 acc=0.8761
Epoch 7 Chunk 4 Step 500: loss=0.8362 acc=0.8754
Epoch 7 Chunk 4 Step 750: loss=0.8357 acc=0.8757
Epoch 7 Chunk 4 Step 1000: loss=0.8350 acc=0.8760
Epoch 7 Chunk 4 Step 1250: loss=0.8355 acc=0.8759
Epoch 7 Chunk 1 Step 0: loss=0.8389 acc=0.8738
Epoch 7 Chunk 1 Step 250: loss=0.8511 acc=0.8705
Epoch 7 Chunk 1 Step 500: loss=0.8511 acc=0.8706
Epoch 7 Chunk 1 Step 750: loss=0.8502 acc=0.8712
Epoch 7 Chunk 1 Step 1000: loss=0.8504 acc=0.8710
Epoch 7 Chunk 1 Step 1250: loss=0.8498 acc=0.8711
Epoch 7 Chunk 1 Step 1500: loss=0.8500 acc=0.8711
Epoch 7 Chunk 1 Step 1750: loss=0.8497 acc=0.8711
Epoch 7 Chunk 1 Step 2000: loss=0.8495 acc=0.8713
Epoch 7 Chunk 5 Step 0: loss=0.8520 acc=0.8789
Epoch 7 Chunk 5 Step 250: loss=0.7857 acc=0.8942
Epoch 7 Chunk 5 Step 500: loss=0.7840 acc=0.8949
Epoch 7 Chunk 3 Step 0: loss=0.8425 acc=0.8748
Epoch 7 Chunk 3 Step 250: loss=0.8393 acc=0.8751
Epoch 7 Chunk 3 Step 500: loss=0.8384 acc=0.8750
Epoch 7 Chunk 3 Step 750: loss=0.8376 acc=0.8752
Epoch 7 Chunk 3 Step 1000: loss=0.8374 acc=0.8753
Epoch 7 Chunk 3 Step 1250: loss=0.8368 acc=0.8754
Epoch 7 Chunk 3 Step 1500: loss=0.8362 acc=0.8757
Epoch 7 Chunk 3 Step 1750: loss=0.8355 acc=0.8760
Epoch 7 Chunk 2 Step 0: loss=0.8313 acc=0.8738
Epoch 7 Chunk 2 Step 250: loss=0.8417 acc=0.8737
Epoch 7 Chunk 2 Step 500: loss=0.8413 acc=0.8738
Epoch 7 Chunk 2 Step 750: loss=0.8404 acc=0.8743
Epoch 7 Chunk 2 Step 1000: loss=0.8402 acc=0.8744
Epoch 7 Chunk 2 Step 1250: loss=0.8402 acc=0.8743
Epoch 7 Chunk 2 Step 1500: loss=0.8397 acc=0.8745
Epoch 7 Chunk 2 Step 1750: loss=0.8398 acc=0.8744
Epoch 7 Chunk 2 Step 2000: loss=0.8400 acc=0.8743
Epoch 7 Chunk 0 Step 0: loss=0.8589 acc=0.8650
Epoch 7 Chunk 0 Step 250: loss=0.8461 acc=0.8724
Epoch 7 Chunk 0 Step 500: loss=0.8465 acc=0.8723
Epoch 7 Chunk 0 Step 750: loss=0.8457 acc=0.8726
Epoch 7 Chunk 0 Step 1000: loss=0.8448 acc=0.8729
Epoch 7 Chunk 0 Step 1250: loss=0.8446 acc=0.8730
Epoch 7 Chunk 0 Step 1500: loss=0.8440 acc=0.8733
Epoch 7 Chunk 0 Step 1750: loss=0.8435 acc=0.8734
Epoch 7 Chunk 0 Step 2000: loss=0.8429 acc=0.8737
Epoch 7 | train_loss=0.8377 train_acc=0.8753 | val_loss=0.7607 val_acc=0.8980 val_macro_f1=0.7245
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 8 Chunk 1 Step 0: loss=0.8071 acc=0.8884
Epoch 8 Chunk 1 Step 250: loss=0.8372 acc=0.8752
Epoch 8 Chunk 1 Step 500: loss=0.8375 acc=0.8755
Epoch 8 Chunk 1 Step 750: loss=0.8370 acc=0.8757
Epoch 8 Chunk 1 Step 1000: loss=0.8361 acc=0.8759
Epoch 8 Chunk 1 Step 1250: loss=0.8362 acc=0.8760
Epoch 8 Chunk 1 Step 1500: loss=0.8357 acc=0.8761
Epoch 8 Chunk 1 Step 1750: loss=0.8356 acc=0.8761
Epoch 8 Chunk 1 Step 2000: loss=0.8358 acc=0.8761
Epoch 8 Chunk 0 Step 0: loss=0.8425 acc=0.8770
Epoch 8 Chunk 0 Step 250: loss=0.8391 acc=0.8748
Epoch 8 Chunk 0 Step 500: loss=0.8370 acc=0.8754
Epoch 8 Chunk 0 Step 750: loss=0.8363 acc=0.8756
Epoch 8 Chunk 0 Step 1000: loss=0.8363 acc=0.8757
Epoch 8 Chunk 0 Step 1250: loss=0.8359 acc=0.8758
Epoch 8 Chunk 0 Step 1500: loss=0.8366 acc=0.8756
Epoch 8 Chunk 0 Step 1750: loss=0.8364 acc=0.8756
Epoch 8 Chunk 0 Step 2000: loss=0.8360 acc=0.8758
Epoch 8 Chunk 5 Step 0: loss=0.8552 acc=0.8740
Epoch 8 Chunk 5 Step 250: loss=0.7821 acc=0.8949
Epoch 8 Chunk 5 Step 500: loss=0.7750 acc=0.8973
Epoch 8 Chunk 4 Step 0: loss=0.8145 acc=0.8860
Epoch 8 Chunk 4 Step 250: loss=0.8169 acc=0.8821
Epoch 8 Chunk 4 Step 500: loss=0.8161 acc=0.8824
Epoch 8 Chunk 4 Step 750: loss=0.8173 acc=0.8820
Epoch 8 Chunk 4 Step 1000: loss=0.8179 acc=0.8817
Epoch 8 Chunk 4 Step 1250: loss=0.8170 acc=0.8820
Epoch 8 Chunk 2 Step 0: loss=0.8246 acc=0.8760
Epoch 8 Chunk 2 Step 250: loss=0.8293 acc=0.8780
Epoch 8 Chunk 2 Step 500: loss=0.8292 acc=0.8779
Epoch 8 Chunk 2 Step 750: loss=0.8276 acc=0.8785
Epoch 8 Chunk 2 Step 1000: loss=0.8272 acc=0.8788
Epoch 8 Chunk 2 Step 1250: loss=0.8269 acc=0.8789
Epoch 8 Chunk 2 Step 1500: loss=0.8272 acc=0.8787
Epoch 8 Chunk 2 Step 1750: loss=0.8273 acc=0.8787
Epoch 8 Chunk 2 Step 2000: loss=0.8278 acc=0.8784
Epoch 8 Chunk 3 Step 0: loss=0.8245 acc=0.8804
Epoch 8 Chunk 3 Step 250: loss=0.8195 acc=0.8809
Epoch 8 Chunk 3 Step 500: loss=0.8178 acc=0.8817
Epoch 8 Chunk 3 Step 750: loss=0.8159 acc=0.8826
Epoch 8 Chunk 3 Step 1000: loss=0.8159 acc=0.8825
Epoch 8 Chunk 3 Step 1250: loss=0.8163 acc=0.8823
Epoch 8 Chunk 3 Step 1500: loss=0.8161 acc=0.8823
Epoch 8 Chunk 3 Step 1750: loss=0.8158 acc=0.8825
Epoch 8 | train_loss=0.8241 train_acc=0.8798 | val_loss=0.7403 val_acc=0.9071 val_macro_f1=0.7365
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 9 Chunk 3 Step 0: loss=0.7901 acc=0.8901
Epoch 9 Chunk 3 Step 250: loss=0.8097 acc=0.8850
Epoch 9 Chunk 3 Step 500: loss=0.8103 acc=0.8844
Epoch 9 Chunk 3 Step 750: loss=0.8111 acc=0.8841
Epoch 9 Chunk 3 Step 1000: loss=0.8112 acc=0.8841
Epoch 9 Chunk 3 Step 1250: loss=0.8124 acc=0.8836
Epoch 9 Chunk 3 Step 1500: loss=0.8127 acc=0.8834
Epoch 9 Chunk 3 Step 1750: loss=0.8127 acc=0.8834
Epoch 9 Chunk 2 Step 0: loss=0.8010 acc=0.8860
Epoch 9 Chunk 2 Step 250: loss=0.8207 acc=0.8811
Epoch 9 Chunk 2 Step 500: loss=0.8204 acc=0.8812
Epoch 9 Chunk 2 Step 750: loss=0.8202 acc=0.8812
Epoch 9 Chunk 2 Step 1000: loss=0.8196 acc=0.8813
Epoch 9 Chunk 2 Step 1250: loss=0.8196 acc=0.8813
Epoch 9 Chunk 2 Step 1500: loss=0.8193 acc=0.8814
Epoch 9 Chunk 2 Step 1750: loss=0.8189 acc=0.8816
Epoch 9 Chunk 2 Step 2000: loss=0.8187 acc=0.8816
Epoch 9 Chunk 0 Step 0: loss=0.8302 acc=0.8735
Epoch 9 Chunk 0 Step 250: loss=0.8279 acc=0.8788
Epoch 9 Chunk 0 Step 500: loss=0.8264 acc=0.8794
Epoch 9 Chunk 0 Step 750: loss=0.8255 acc=0.8798
Epoch 9 Chunk 0 Step 1000: loss=0.8250 acc=0.8798
Epoch 9 Chunk 0 Step 1250: loss=0.8244 acc=0.8799
Epoch 9 Chunk 0 Step 1500: loss=0.8242 acc=0.8799
Epoch 9 Chunk 0 Step 1750: loss=0.8237 acc=0.8801
Epoch 9 Chunk 0 Step 2000: loss=0.8235 acc=0.8801
Epoch 9 Chunk 5 Step 0: loss=0.8845 acc=0.8660
Epoch 9 Chunk 5 Step 250: loss=0.7625 acc=0.9018
Epoch 9 Chunk 5 Step 500: loss=0.7599 acc=0.9027
Epoch 9 Chunk 4 Step 0: loss=0.8399 acc=0.8694
Epoch 9 Chunk 4 Step 250: loss=0.8041 acc=0.8866
Epoch 9 Chunk 4 Step 500: loss=0.8031 acc=0.8869
Epoch 9 Chunk 4 Step 750: loss=0.8016 acc=0.8875
Epoch 9 Chunk 4 Step 1000: loss=0.8018 acc=0.8874
Epoch 9 Chunk 4 Step 1250: loss=0.8018 acc=0.8874
Epoch 9 Chunk 1 Step 0: loss=0.8199 acc=0.8767
Epoch 9 Chunk 1 Step 250: loss=0.8184 acc=0.8816
Epoch 9 Chunk 1 Step 500: loss=0.8175 acc=0.8818
Epoch 9 Chunk 1 Step 750: loss=0.8181 acc=0.8818
Epoch 9 Chunk 1 Step 1000: loss=0.8170 acc=0.8821
Epoch 9 Chunk 1 Step 1250: loss=0.8171 acc=0.8821
Epoch 9 Chunk 1 Step 1500: loss=0.8173 acc=0.8820
Epoch 9 Chunk 1 Step 1750: loss=0.8169 acc=0.8822
Epoch 9 Chunk 1 Step 2000: loss=0.8165 acc=0.8823
Epoch 9 | train_loss=0.8121 train_acc=0.8839 | val_loss=0.7469 val_acc=0.9000 val_macro_f1=0.7402
Epoch 10 Chunk 4 Step 0: loss=0.7970 acc=0.8884
Epoch 10 Chunk 4 Step 250: loss=0.8018 acc=0.8865
Epoch 10 Chunk 4 Step 500: loss=0.8007 acc=0.8871
Epoch 10 Chunk 4 Step 750: loss=0.8005 acc=0.8872
Epoch 10 Chunk 4 Step 1000: loss=0.8000 acc=0.8875
Epoch 10 Chunk 4 Step 1250: loss=0.8004 acc=0.8872
Epoch 10 Chunk 5 Step 0: loss=0.7632 acc=0.8997
Epoch 10 Chunk 5 Step 250: loss=0.7530 acc=0.9051
Epoch 10 Chunk 5 Step 500: loss=0.7520 acc=0.9052
Epoch 10 Chunk 1 Step 0: loss=0.8726 acc=0.8687
Epoch 10 Chunk 1 Step 250: loss=0.8172 acc=0.8822
Epoch 10 Chunk 1 Step 500: loss=0.8142 acc=0.8831
Epoch 10 Chunk 1 Step 750: loss=0.8131 acc=0.8835
Epoch 10 Chunk 1 Step 1000: loss=0.8120 acc=0.8839
Epoch 10 Chunk 1 Step 1250: loss=0.8117 acc=0.8841
Epoch 10 Chunk 1 Step 1500: loss=0.8119 acc=0.8839
Epoch 10 Chunk 1 Step 1750: loss=0.8113 acc=0.8841
Epoch 10 Chunk 1 Step 2000: loss=0.8112 acc=0.8842
Epoch 10 Chunk 3 Step 0: loss=0.8248 acc=0.8787
Epoch 10 Chunk 3 Step 250: loss=0.8057 acc=0.8857
Epoch 10 Chunk 3 Step 500: loss=0.8052 acc=0.8861
Epoch 10 Chunk 3 Step 750: loss=0.8030 acc=0.8869
Epoch 10 Chunk 3 Step 1000: loss=0.8016 acc=0.8873
Epoch 10 Chunk 3 Step 1250: loss=0.8015 acc=0.8872
Epoch 10 Chunk 3 Step 1500: loss=0.8009 acc=0.8874
Epoch 10 Chunk 3 Step 1750: loss=0.8008 acc=0.8874
Epoch 10 Chunk 0 Step 0: loss=0.8076 acc=0.8882
Epoch 10 Chunk 0 Step 250: loss=0.8152 acc=0.8824
Epoch 10 Chunk 0 Step 500: loss=0.8137 acc=0.8830
Epoch 10 Chunk 0 Step 750: loss=0.8142 acc=0.8828
Epoch 10 Chunk 0 Step 1000: loss=0.8146 acc=0.8826
Epoch 10 Chunk 0 Step 1250: loss=0.8140 acc=0.8829
Epoch 10 Chunk 0 Step 1500: loss=0.8129 acc=0.8834
Epoch 10 Chunk 0 Step 1750: loss=0.8125 acc=0.8835
Epoch 10 Chunk 0 Step 2000: loss=0.8122 acc=0.8836
Epoch 10 Chunk 2 Step 0: loss=0.7995 acc=0.8904
Epoch 10 Chunk 2 Step 250: loss=0.8039 acc=0.8868
Epoch 10 Chunk 2 Step 500: loss=0.8040 acc=0.8867
Epoch 10 Chunk 2 Step 750: loss=0.8055 acc=0.8858
Epoch 10 Chunk 2 Step 1000: loss=0.8061 acc=0.8856
Epoch 10 Chunk 2 Step 1250: loss=0.8059 acc=0.8857
Epoch 10 Chunk 2 Step 1500: loss=0.8059 acc=0.8856
Epoch 10 Chunk 2 Step 1750: loss=0.8057 acc=0.8857
Epoch 10 Chunk 2 Step 2000: loss=0.8056 acc=0.8857
Epoch 10 | train_loss=0.8032 train_acc=0.8867 | val_loss=0.7278 val_acc=0.9102 val_macro_f1=0.7490
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 11 Chunk 0 Step 0: loss=0.8305 acc=0.8794
Epoch 11 Chunk 0 Step 250: loss=0.8118 acc=0.8829
Epoch 11 Chunk 0 Step 500: loss=0.8096 acc=0.8840
Epoch 11 Chunk 0 Step 750: loss=0.8079 acc=0.8848
Epoch 11 Chunk 0 Step 1000: loss=0.8079 acc=0.8849
Epoch 11 Chunk 0 Step 1250: loss=0.8071 acc=0.8853
Epoch 11 Chunk 0 Step 1500: loss=0.8069 acc=0.8853
Epoch 11 Chunk 0 Step 1750: loss=0.8064 acc=0.8855
Epoch 11 Chunk 0 Step 2000: loss=0.8062 acc=0.8856
Epoch 11 Chunk 5 Step 0: loss=0.7760 acc=0.8960
Epoch 11 Chunk 5 Step 250: loss=0.7518 acc=0.9051
Epoch 11 Chunk 5 Step 500: loss=0.7487 acc=0.9060
Epoch 11 Chunk 2 Step 0: loss=0.8480 acc=0.8665
Epoch 11 Chunk 2 Step 250: loss=0.8018 acc=0.8872
Epoch 11 Chunk 2 Step 500: loss=0.8009 acc=0.8873
Epoch 11 Chunk 2 Step 750: loss=0.8005 acc=0.8874
Epoch 11 Chunk 2 Step 1000: loss=0.8005 acc=0.8875
Epoch 11 Chunk 2 Step 1250: loss=0.8005 acc=0.8875
Epoch 11 Chunk 2 Step 1500: loss=0.8002 acc=0.8876
Epoch 11 Chunk 2 Step 1750: loss=0.8004 acc=0.8875
Epoch 11 Chunk 2 Step 2000: loss=0.8002 acc=0.8876
Epoch 11 Chunk 3 Step 0: loss=0.7819 acc=0.8965
Epoch 11 Chunk 3 Step 250: loss=0.7892 acc=0.8914
Epoch 11 Chunk 3 Step 500: loss=0.7891 acc=0.8915
Epoch 11 Chunk 3 Step 750: loss=0.7890 acc=0.8915
Epoch 11 Chunk 3 Step 1000: loss=0.7902 acc=0.8910
Epoch 11 Chunk 3 Step 1250: loss=0.7900 acc=0.8911
Epoch 11 Chunk 3 Step 1500: loss=0.7901 acc=0.8910
Epoch 11 Chunk 3 Step 1750: loss=0.7898 acc=0.8910
Epoch 11 Chunk 1 Step 0: loss=0.8008 acc=0.8813
Epoch 11 Chunk 1 Step 250: loss=0.8014 acc=0.8871
Epoch 11 Chunk 1 Step 500: loss=0.8022 acc=0.8868
Epoch 11 Chunk 1 Step 750: loss=0.8021 acc=0.8867
Epoch 11 Chunk 1 Step 1000: loss=0.8010 acc=0.8872
Epoch 11 Chunk 1 Step 1250: loss=0.8000 acc=0.8876
Epoch 11 Chunk 1 Step 1500: loss=0.7997 acc=0.8877
Epoch 11 Chunk 1 Step 1750: loss=0.7988 acc=0.8881
Epoch 11 Chunk 1 Step 2000: loss=0.7991 acc=0.8880
Epoch 11 Chunk 4 Step 0: loss=0.7708 acc=0.8967
Epoch 11 Chunk 4 Step 250: loss=0.7851 acc=0.8928
Epoch 11 Chunk 4 Step 500: loss=0.7839 acc=0.8930
Epoch 11 Chunk 4 Step 750: loss=0.7846 acc=0.8928
Epoch 11 Chunk 4 Step 1000: loss=0.7841 acc=0.8930
Epoch 11 Chunk 4 Step 1250: loss=0.7837 acc=0.8931
Epoch 11 | train_loss=0.7938 train_acc=0.8898 | val_loss=0.7220 val_acc=0.9115 val_macro_f1=0.7480
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 12 Chunk 0 Step 0: loss=0.8134 acc=0.8779
Epoch 12 Chunk 0 Step 250: loss=0.8022 acc=0.8867
Epoch 12 Chunk 0 Step 500: loss=0.8023 acc=0.8868
Epoch 12 Chunk 0 Step 750: loss=0.8003 acc=0.8876
Epoch 12 Chunk 0 Step 1000: loss=0.7995 acc=0.8878
Epoch 12 Chunk 0 Step 1250: loss=0.7993 acc=0.8879
Epoch 12 Chunk 0 Step 1500: loss=0.7987 acc=0.8881
Epoch 12 Chunk 0 Step 1750: loss=0.7984 acc=0.8882
Epoch 12 Chunk 0 Step 2000: loss=0.7985 acc=0.8882
Epoch 12 Chunk 4 Step 0: loss=0.8071 acc=0.8845
Epoch 12 Chunk 4 Step 250: loss=0.7840 acc=0.8920
Epoch 12 Chunk 4 Step 500: loss=0.7828 acc=0.8926
Epoch 12 Chunk 4 Step 750: loss=0.7815 acc=0.8933
Epoch 12 Chunk 4 Step 1000: loss=0.7811 acc=0.8935
Epoch 12 Chunk 4 Step 1250: loss=0.7808 acc=0.8938
Epoch 12 Chunk 5 Step 0: loss=0.7456 acc=0.9062
Epoch 12 Chunk 5 Step 250: loss=0.7392 acc=0.9092
Epoch 12 Chunk 5 Step 500: loss=0.7377 acc=0.9099
Epoch 12 Chunk 2 Step 0: loss=0.8405 acc=0.8674
Epoch 12 Chunk 2 Step 250: loss=0.7939 acc=0.8896
Epoch 12 Chunk 2 Step 500: loss=0.7933 acc=0.8898
Epoch 12 Chunk 2 Step 750: loss=0.7930 acc=0.8900
Epoch 12 Chunk 2 Step 1000: loss=0.7929 acc=0.8901
Epoch 12 Chunk 2 Step 1250: loss=0.7920 acc=0.8904
Epoch 12 Chunk 2 Step 1500: loss=0.7921 acc=0.8903
Epoch 12 Chunk 2 Step 1750: loss=0.7919 acc=0.8903
Epoch 12 Chunk 2 Step 2000: loss=0.7917 acc=0.8904
Epoch 12 Chunk 3 Step 0: loss=0.7810 acc=0.8972
Epoch 12 Chunk 3 Step 250: loss=0.7831 acc=0.8933
Epoch 12 Chunk 3 Step 500: loss=0.7828 acc=0.8933
Epoch 12 Chunk 3 Step 750: loss=0.7826 acc=0.8933
Epoch 12 Chunk 3 Step 1000: loss=0.7826 acc=0.8933
Epoch 12 Chunk 3 Step 1250: loss=0.7826 acc=0.8933
Epoch 12 Chunk 3 Step 1500: loss=0.7828 acc=0.8932
Epoch 12 Chunk 3 Step 1750: loss=0.7823 acc=0.8934
Epoch 12 Chunk 1 Step 0: loss=0.7909 acc=0.8918
Epoch 12 Chunk 1 Step 250: loss=0.7933 acc=0.8898
Epoch 12 Chunk 1 Step 500: loss=0.7946 acc=0.8891
Epoch 12 Chunk 1 Step 750: loss=0.7938 acc=0.8894
Epoch 12 Chunk 1 Step 1000: loss=0.7939 acc=0.8894
Epoch 12 Chunk 1 Step 1250: loss=0.7932 acc=0.8898
Epoch 12 Chunk 1 Step 1500: loss=0.7926 acc=0.8900
Epoch 12 Chunk 1 Step 1750: loss=0.7927 acc=0.8899
Epoch 12 Chunk 1 Step 2000: loss=0.7922 acc=0.8902
Epoch 12 | train_loss=0.7867 train_acc=0.8921 | val_loss=0.7177 val_acc=0.9127 val_macro_f1=0.7519
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 13 Chunk 5 Step 0: loss=0.7858 acc=0.8904
Epoch 13 Chunk 5 Step 250: loss=0.7374 acc=0.9098
Epoch 13 Chunk 5 Step 500: loss=0.7352 acc=0.9104
Epoch 13 Chunk 3 Step 0: loss=0.7955 acc=0.8926
Epoch 13 Chunk 3 Step 250: loss=0.7781 acc=0.8952
Epoch 13 Chunk 3 Step 500: loss=0.7797 acc=0.8943
Epoch 13 Chunk 3 Step 750: loss=0.7788 acc=0.8947
Epoch 13 Chunk 3 Step 1000: loss=0.7786 acc=0.8946
Epoch 13 Chunk 3 Step 1250: loss=0.7785 acc=0.8947
Epoch 13 Chunk 3 Step 1500: loss=0.7780 acc=0.8949
Epoch 13 Chunk 3 Step 1750: loss=0.7779 acc=0.8949
Epoch 13 Chunk 2 Step 0: loss=0.7947 acc=0.8923
Epoch 13 Chunk 2 Step 250: loss=0.7851 acc=0.8925
Epoch 13 Chunk 2 Step 500: loss=0.7865 acc=0.8922
Epoch 13 Chunk 2 Step 750: loss=0.7863 acc=0.8922
Epoch 13 Chunk 2 Step 1000: loss=0.7864 acc=0.8921
Epoch 13 Chunk 2 Step 1250: loss=0.7866 acc=0.8920
Epoch 13 Chunk 2 Step 1500: loss=0.7864 acc=0.8920
Epoch 13 Chunk 2 Step 1750: loss=0.7863 acc=0.8920
Epoch 13 Chunk 2 Step 2000: loss=0.7862 acc=0.8920
Epoch 13 Chunk 4 Step 0: loss=0.7564 acc=0.9001
Epoch 13 Chunk 4 Step 250: loss=0.7738 acc=0.8962
Epoch 13 Chunk 4 Step 500: loss=0.7732 acc=0.8965
Epoch 13 Chunk 4 Step 750: loss=0.7726 acc=0.8967
Epoch 13 Chunk 4 Step 1000: loss=0.7723 acc=0.8967
Epoch 13 Chunk 4 Step 1250: loss=0.7720 acc=0.8969
Epoch 13 Chunk 1 Step 0: loss=0.7811 acc=0.8916
Epoch 13 Chunk 1 Step 250: loss=0.7860 acc=0.8923
Epoch 13 Chunk 1 Step 500: loss=0.7863 acc=0.8920
Epoch 13 Chunk 1 Step 750: loss=0.7864 acc=0.8920
Epoch 13 Chunk 1 Step 1000: loss=0.7865 acc=0.8920
Epoch 13 Chunk 1 Step 1250: loss=0.7863 acc=0.8921
Epoch 13 Chunk 1 Step 1500: loss=0.7861 acc=0.8922
Epoch 13 Chunk 1 Step 1750: loss=0.7864 acc=0.8921
Epoch 13 Chunk 1 Step 2000: loss=0.7858 acc=0.8923
Epoch 13 Chunk 0 Step 0: loss=0.7846 acc=0.8923
Epoch 13 Chunk 0 Step 250: loss=0.7878 acc=0.8916
Epoch 13 Chunk 0 Step 500: loss=0.7892 acc=0.8912
Epoch 13 Chunk 0 Step 750: loss=0.7884 acc=0.8914
Epoch 13 Chunk 0 Step 1000: loss=0.7879 acc=0.8916
Epoch 13 Chunk 0 Step 1250: loss=0.7876 acc=0.8917
Epoch 13 Chunk 0 Step 1500: loss=0.7875 acc=0.8917
Epoch 13 Chunk 0 Step 1750: loss=0.7874 acc=0.8918
Epoch 13 Chunk 0 Step 2000: loss=0.7879 acc=0.8916
Epoch 13 | train_loss=0.7798 train_acc=0.8943 | val_loss=0.7124 val_acc=0.9145 val_macro_f1=0.7566
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 14 Chunk 5 Step 0: loss=0.8017 acc=0.8899
Epoch 14 Chunk 5 Step 250: loss=0.7339 acc=0.9109
Epoch 14 Chunk 5 Step 500: loss=0.7303 acc=0.9120
Epoch 14 Chunk 1 Step 0: loss=0.8130 acc=0.8804
Epoch 14 Chunk 1 Step 250: loss=0.7832 acc=0.8930
Epoch 14 Chunk 1 Step 500: loss=0.7821 acc=0.8935
Epoch 14 Chunk 1 Step 750: loss=0.7821 acc=0.8935
Epoch 14 Chunk 1 Step 1000: loss=0.7818 acc=0.8935
Epoch 14 Chunk 1 Step 1250: loss=0.7813 acc=0.8938
Epoch 14 Chunk 1 Step 1500: loss=0.7812 acc=0.8938
Epoch 14 Chunk 1 Step 1750: loss=0.7809 acc=0.8939
Epoch 14 Chunk 1 Step 2000: loss=0.7807 acc=0.8940
Epoch 14 Chunk 2 Step 0: loss=0.7841 acc=0.8928
Epoch 14 Chunk 2 Step 250: loss=0.7799 acc=0.8943
Epoch 14 Chunk 2 Step 500: loss=0.7796 acc=0.8943
Epoch 14 Chunk 2 Step 750: loss=0.7801 acc=0.8941
Epoch 14 Chunk 2 Step 1000: loss=0.7802 acc=0.8940
Epoch 14 Chunk 2 Step 1250: loss=0.7794 acc=0.8943
Epoch 14 Chunk 2 Step 1500: loss=0.7793 acc=0.8944
Epoch 14 Chunk 2 Step 1750: loss=0.7793 acc=0.8943
Epoch 14 Chunk 2 Step 2000: loss=0.7790 acc=0.8944
Epoch 14 Chunk 3 Step 0: loss=0.8005 acc=0.8855
Epoch 14 Chunk 3 Step 250: loss=0.7726 acc=0.8965
Epoch 14 Chunk 3 Step 500: loss=0.7715 acc=0.8969
Epoch 14 Chunk 3 Step 750: loss=0.7711 acc=0.8970
Epoch 14 Chunk 3 Step 1000: loss=0.7702 acc=0.8973
Epoch 14 Chunk 3 Step 1250: loss=0.7706 acc=0.8972
Epoch 14 Chunk 3 Step 1500: loss=0.7706 acc=0.8971
Epoch 14 Chunk 3 Step 1750: loss=0.7706 acc=0.8971
Epoch 14 Chunk 0 Step 0: loss=0.7707 acc=0.8977
Epoch 14 Chunk 0 Step 250: loss=0.7842 acc=0.8929
Epoch 14 Chunk 0 Step 500: loss=0.7833 acc=0.8932
Epoch 14 Chunk 0 Step 750: loss=0.7829 acc=0.8935
Epoch 14 Chunk 0 Step 1000: loss=0.7830 acc=0.8934
Epoch 14 Chunk 0 Step 1250: loss=0.7835 acc=0.8931
Epoch 14 Chunk 0 Step 1500: loss=0.7829 acc=0.8933
Epoch 14 Chunk 0 Step 1750: loss=0.7827 acc=0.8933
Epoch 14 Chunk 0 Step 2000: loss=0.7827 acc=0.8934
Epoch 14 Chunk 4 Step 0: loss=0.7434 acc=0.9121
Epoch 14 Chunk 4 Step 250: loss=0.7655 acc=0.8989
Epoch 14 Chunk 4 Step 500: loss=0.7660 acc=0.8987
Epoch 14 Chunk 4 Step 750: loss=0.7663 acc=0.8985
Epoch 14 Chunk 4 Step 1000: loss=0.7657 acc=0.8988
Epoch 14 Chunk 4 Step 1250: loss=0.7654 acc=0.8988
Epoch 14 | train_loss=0.7738 train_acc=0.8963 | val_loss=0.7087 val_acc=0.9159 val_macro_f1=0.7599
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 15 Chunk 4 Step 0: loss=0.7635 acc=0.9011
Epoch 15 Chunk 4 Step 250: loss=0.7626 acc=0.8996
Epoch 15 Chunk 4 Step 500: loss=0.7620 acc=0.9000
Epoch 15 Chunk 4 Step 750: loss=0.7619 acc=0.9002
Epoch 15 Chunk 4 Step 1000: loss=0.7618 acc=0.9002
Epoch 15 Chunk 4 Step 1250: loss=0.7617 acc=0.9002
Epoch 15 Chunk 1 Step 0: loss=0.8007 acc=0.8872
Epoch 15 Chunk 1 Step 250: loss=0.7785 acc=0.8950
Epoch 15 Chunk 1 Step 500: loss=0.7777 acc=0.8952
Epoch 15 Chunk 1 Step 750: loss=0.7768 acc=0.8953
Epoch 15 Chunk 1 Step 1000: loss=0.7766 acc=0.8954
Epoch 15 Chunk 1 Step 1250: loss=0.7761 acc=0.8955
Epoch 15 Chunk 1 Step 1500: loss=0.7760 acc=0.8956
Epoch 15 Chunk 1 Step 1750: loss=0.7758 acc=0.8957
Epoch 15 Chunk 1 Step 2000: loss=0.7757 acc=0.8957
Epoch 15 Chunk 3 Step 0: loss=0.7986 acc=0.8872
Epoch 15 Chunk 3 Step 250: loss=0.7665 acc=0.8988
Epoch 15 Chunk 3 Step 500: loss=0.7666 acc=0.8988
Epoch 15 Chunk 3 Step 750: loss=0.7664 acc=0.8988
Epoch 15 Chunk 3 Step 1000: loss=0.7660 acc=0.8989
Epoch 15 Chunk 3 Step 1250: loss=0.7661 acc=0.8988
Epoch 15 Chunk 3 Step 1500: loss=0.7663 acc=0.8987
Epoch 15 Chunk 3 Step 1750: loss=0.7660 acc=0.8988
Epoch 15 Chunk 5 Step 0: loss=0.7536 acc=0.9023
Epoch 15 Chunk 5 Step 250: loss=0.7242 acc=0.9141
Epoch 15 Chunk 5 Step 500: loss=0.7231 acc=0.9144
Epoch 15 Chunk 2 Step 0: loss=0.7777 acc=0.8896
Epoch 15 Chunk 2 Step 250: loss=0.7746 acc=0.8959
Epoch 15 Chunk 2 Step 500: loss=0.7744 acc=0.8958
Epoch 15 Chunk 2 Step 750: loss=0.7745 acc=0.8958
Epoch 15 Chunk 2 Step 1000: loss=0.7738 acc=0.8961
Epoch 15 Chunk 2 Step 1250: loss=0.7738 acc=0.8961
Epoch 15 Chunk 2 Step 1500: loss=0.7737 acc=0.8962
Epoch 15 Chunk 2 Step 1750: loss=0.7736 acc=0.8962
Epoch 15 Chunk 2 Step 2000: loss=0.7734 acc=0.8962
Epoch 15 Chunk 0 Step 0: loss=0.7527 acc=0.9043
Epoch 15 Chunk 0 Step 250: loss=0.7788 acc=0.8941
Epoch 15 Chunk 0 Step 500: loss=0.7785 acc=0.8944
Epoch 15 Chunk 0 Step 750: loss=0.7780 acc=0.8948
Epoch 15 Chunk 0 Step 1000: loss=0.7774 acc=0.8950
Epoch 15 Chunk 0 Step 1250: loss=0.7770 acc=0.8952
Epoch 15 Chunk 0 Step 1500: loss=0.7767 acc=0.8953
Epoch 15 Chunk 0 Step 1750: loss=0.7768 acc=0.8953
Epoch 15 Chunk 0 Step 2000: loss=0.7768 acc=0.8953
Epoch 15 | train_loss=0.7685 train_acc=0.8981 | val_loss=0.7039 val_acc=0.9166 val_macro_f1=0.7617
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 16 Chunk 3 Step 0: loss=0.7708 acc=0.8972
Epoch 16 Chunk 3 Step 250: loss=0.7626 acc=0.9003
Epoch 16 Chunk 3 Step 500: loss=0.7621 acc=0.9003
Epoch 16 Chunk 3 Step 750: loss=0.7618 acc=0.9003
Epoch 16 Chunk 3 Step 1000: loss=0.7614 acc=0.9004
Epoch 16 Chunk 3 Step 1250: loss=0.7616 acc=0.9003
Epoch 16 Chunk 3 Step 1500: loss=0.7616 acc=0.9003
Epoch 16 Chunk 3 Step 1750: loss=0.7617 acc=0.9002
Epoch 16 Chunk 0 Step 0: loss=0.7772 acc=0.8989
Epoch 16 Chunk 0 Step 250: loss=0.7751 acc=0.8955
Epoch 16 Chunk 0 Step 500: loss=0.7752 acc=0.8956
Epoch 16 Chunk 0 Step 750: loss=0.7746 acc=0.8958
Epoch 16 Chunk 0 Step 1000: loss=0.7745 acc=0.8959
Epoch 16 Chunk 0 Step 1250: loss=0.7746 acc=0.8960
Epoch 16 Chunk 0 Step 1500: loss=0.7743 acc=0.8961
Epoch 16 Chunk 0 Step 1750: loss=0.7740 acc=0.8961
Epoch 16 Chunk 0 Step 2000: loss=0.7738 acc=0.8962
Epoch 16 Chunk 2 Step 0: loss=0.7930 acc=0.8906
Epoch 16 Chunk 2 Step 250: loss=0.7700 acc=0.8976
Epoch 16 Chunk 2 Step 500: loss=0.7697 acc=0.8974
Epoch 16 Chunk 2 Step 750: loss=0.7694 acc=0.8975
Epoch 16 Chunk 2 Step 1000: loss=0.7695 acc=0.8974
Epoch 16 Chunk 2 Step 1250: loss=0.7693 acc=0.8975
Epoch 16 Chunk 2 Step 1500: loss=0.7697 acc=0.8974
Epoch 16 Chunk 2 Step 1750: loss=0.7695 acc=0.8975
Epoch 16 Chunk 2 Step 2000: loss=0.7694 acc=0.8975
Epoch 16 Chunk 5 Step 0: loss=0.7714 acc=0.8975
Epoch 16 Chunk 5 Step 250: loss=0.7233 acc=0.9138
Epoch 16 Chunk 5 Step 500: loss=0.7205 acc=0.9148
Epoch 16 Chunk 1 Step 0: loss=0.7891 acc=0.8894
Epoch 16 Chunk 1 Step 250: loss=0.7719 acc=0.8967
Epoch 16 Chunk 1 Step 500: loss=0.7712 acc=0.8969
Epoch 16 Chunk 1 Step 750: loss=0.7708 acc=0.8970
Epoch 16 Chunk 1 Step 1000: loss=0.7708 acc=0.8971
Epoch 16 Chunk 1 Step 1250: loss=0.7703 acc=0.8974
Epoch 16 Chunk 1 Step 1500: loss=0.7701 acc=0.8974
Epoch 16 Chunk 1 Step 1750: loss=0.7698 acc=0.8975
Epoch 16 Chunk 1 Step 2000: loss=0.7699 acc=0.8974
Epoch 16 Chunk 4 Step 0: loss=0.7508 acc=0.9033
Epoch 16 Chunk 4 Step 250: loss=0.7578 acc=0.9015
Epoch 16 Chunk 4 Step 500: loss=0.7576 acc=0.9014
Epoch 16 Chunk 4 Step 750: loss=0.7572 acc=0.9016
Epoch 16 Chunk 4 Step 1000: loss=0.7570 acc=0.9016
Epoch 16 Chunk 4 Step 1250: loss=0.7568 acc=0.9017
Epoch 16 | train_loss=0.7643 train_acc=0.8994 | val_loss=0.7075 val_acc=0.9170 val_macro_f1=0.7642
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 17 Chunk 5 Step 0: loss=0.7666 acc=0.8945
Epoch 17 Chunk 5 Step 250: loss=0.7179 acc=0.9161
Epoch 17 Chunk 5 Step 500: loss=0.7168 acc=0.9163
Epoch 17 Chunk 2 Step 0: loss=0.7862 acc=0.8918
Epoch 17 Chunk 2 Step 250: loss=0.7700 acc=0.8973
Epoch 17 Chunk 2 Step 500: loss=0.7683 acc=0.8978
Epoch 17 Chunk 2 Step 750: loss=0.7679 acc=0.8980
Epoch 17 Chunk 2 Step 1000: loss=0.7675 acc=0.8981
Epoch 17 Chunk 2 Step 1250: loss=0.7671 acc=0.8983
Epoch 17 Chunk 2 Step 1500: loss=0.7668 acc=0.8984
Epoch 17 Chunk 2 Step 1750: loss=0.7667 acc=0.8983
Epoch 17 Chunk 2 Step 2000: loss=0.7665 acc=0.8984
Epoch 17 Chunk 4 Step 0: loss=0.7576 acc=0.8999
Epoch 17 Chunk 4 Step 250: loss=0.7536 acc=0.9027
Epoch 17 Chunk 4 Step 500: loss=0.7540 acc=0.9025
Epoch 17 Chunk 4 Step 750: loss=0.7540 acc=0.9025
Epoch 17 Chunk 4 Step 1000: loss=0.7535 acc=0.9027
Epoch 17 Chunk 4 Step 1250: loss=0.7535 acc=0.9027
Epoch 17 Chunk 3 Step 0: loss=0.7368 acc=0.9097
Epoch 17 Chunk 3 Step 250: loss=0.7579 acc=0.9014
Epoch 17 Chunk 3 Step 500: loss=0.7578 acc=0.9014
Epoch 17 Chunk 3 Step 750: loss=0.7579 acc=0.9014
Epoch 17 Chunk 3 Step 1000: loss=0.7578 acc=0.9015
Epoch 17 Chunk 3 Step 1250: loss=0.7575 acc=0.9015
Epoch 17 Chunk 3 Step 1500: loss=0.7576 acc=0.9015
Epoch 17 Chunk 3 Step 1750: loss=0.7574 acc=0.9016
Epoch 17 Chunk 0 Step 0: loss=0.7784 acc=0.8953
Epoch 17 Chunk 0 Step 250: loss=0.7724 acc=0.8964
Epoch 17 Chunk 0 Step 500: loss=0.7714 acc=0.8968
Epoch 17 Chunk 0 Step 750: loss=0.7705 acc=0.8972
Epoch 17 Chunk 0 Step 1000: loss=0.7703 acc=0.8974
Epoch 17 Chunk 0 Step 1250: loss=0.7698 acc=0.8975
Epoch 17 Chunk 0 Step 1500: loss=0.7698 acc=0.8975
Epoch 17 Chunk 0 Step 1750: loss=0.7695 acc=0.8977
Epoch 17 Chunk 0 Step 2000: loss=0.7696 acc=0.8976
Epoch 17 Chunk 1 Step 0: loss=0.7533 acc=0.9045
Epoch 17 Chunk 1 Step 250: loss=0.7669 acc=0.8983
Epoch 17 Chunk 1 Step 500: loss=0.7660 acc=0.8987
Epoch 17 Chunk 1 Step 750: loss=0.7660 acc=0.8987
Epoch 17 Chunk 1 Step 1000: loss=0.7660 acc=0.8987
Epoch 17 Chunk 1 Step 1250: loss=0.7662 acc=0.8986
Epoch 17 Chunk 1 Step 1500: loss=0.7660 acc=0.8987
Epoch 17 Chunk 1 Step 1750: loss=0.7658 acc=0.8988
Epoch 17 Chunk 1 Step 2000: loss=0.7657 acc=0.8988
Epoch 17 | train_loss=0.7605 train_acc=0.9006 | val_loss=0.7005 val_acc=0.9180 val_macro_f1=0.7644
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 18 Chunk 4 Step 0: loss=0.7579 acc=0.9041
Epoch 18 Chunk 4 Step 250: loss=0.7529 acc=0.9029
Epoch 18 Chunk 4 Step 500: loss=0.7521 acc=0.9031
Epoch 18 Chunk 4 Step 750: loss=0.7517 acc=0.9032
Epoch 18 Chunk 4 Step 1000: loss=0.7517 acc=0.9031
Epoch 18 Chunk 4 Step 1250: loss=0.7517 acc=0.9031
Epoch 18 Chunk 0 Step 0: loss=0.7645 acc=0.8962
Epoch 18 Chunk 0 Step 250: loss=0.7681 acc=0.8981
Epoch 18 Chunk 0 Step 500: loss=0.7675 acc=0.8983
Epoch 18 Chunk 0 Step 750: loss=0.7668 acc=0.8985
Epoch 18 Chunk 0 Step 1000: loss=0.7667 acc=0.8985
Epoch 18 Chunk 0 Step 1250: loss=0.7667 acc=0.8985
Epoch 18 Chunk 0 Step 1500: loss=0.7668 acc=0.8985
Epoch 18 Chunk 0 Step 1750: loss=0.7667 acc=0.8985
Epoch 18 Chunk 0 Step 2000: loss=0.7667 acc=0.8985
Epoch 18 Chunk 3 Step 0: loss=0.7675 acc=0.8997
Epoch 18 Chunk 3 Step 250: loss=0.7559 acc=0.9020
Epoch 18 Chunk 3 Step 500: loss=0.7554 acc=0.9021
Epoch 18 Chunk 3 Step 750: loss=0.7550 acc=0.9023
Epoch 18 Chunk 3 Step 1000: loss=0.7552 acc=0.9022
Epoch 18 Chunk 3 Step 1250: loss=0.7551 acc=0.9022
Epoch 18 Chunk 3 Step 1500: loss=0.7549 acc=0.9023
Epoch 18 Chunk 3 Step 1750: loss=0.7549 acc=0.9023
Epoch 18 Chunk 1 Step 0: loss=0.7814 acc=0.8943
Epoch 18 Chunk 1 Step 250: loss=0.7640 acc=0.8996
Epoch 18 Chunk 1 Step 500: loss=0.7640 acc=0.8996
Epoch 18 Chunk 1 Step 750: loss=0.7639 acc=0.8995
Epoch 18 Chunk 1 Step 1000: loss=0.7636 acc=0.8996
Epoch 18 Chunk 1 Step 1250: loss=0.7632 acc=0.8997
Epoch 18 Chunk 1 Step 1500: loss=0.7632 acc=0.8997
Epoch 18 Chunk 1 Step 1750: loss=0.7630 acc=0.8997
Epoch 18 Chunk 1 Step 2000: loss=0.7630 acc=0.8996
Epoch 18 Chunk 5 Step 0: loss=0.7569 acc=0.9021
Epoch 18 Chunk 5 Step 250: loss=0.7165 acc=0.9164
Epoch 18 Chunk 5 Step 500: loss=0.7143 acc=0.9169
Epoch 18 Chunk 2 Step 0: loss=0.7701 acc=0.8948
Epoch 18 Chunk 2 Step 250: loss=0.7658 acc=0.8984
Epoch 18 Chunk 2 Step 500: loss=0.7640 acc=0.8989
Epoch 18 Chunk 2 Step 750: loss=0.7634 acc=0.8992
Epoch 18 Chunk 2 Step 1000: loss=0.7629 acc=0.8994
Epoch 18 Chunk 2 Step 1250: loss=0.7628 acc=0.8994
Epoch 18 Chunk 2 Step 1500: loss=0.7627 acc=0.8995
Epoch 18 Chunk 2 Step 1750: loss=0.7626 acc=0.8995
Epoch 18 Chunk 2 Step 2000: loss=0.7625 acc=0.8996
Epoch 18 | train_loss=0.7576 train_acc=0.9014 | val_loss=0.6964 val_acc=0.9188 val_macro_f1=0.7669
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 19 Chunk 0 Step 0: loss=0.7626 acc=0.9060
Epoch 19 Chunk 0 Step 250: loss=0.7650 acc=0.8993
Epoch 19 Chunk 0 Step 500: loss=0.7650 acc=0.8992
Epoch 19 Chunk 0 Step 750: loss=0.7651 acc=0.8991
Epoch 19 Chunk 0 Step 1000: loss=0.7646 acc=0.8992
Epoch 19 Chunk 0 Step 1250: loss=0.7644 acc=0.8992
Epoch 19 Chunk 0 Step 1500: loss=0.7645 acc=0.8993
Epoch 19 Chunk 0 Step 1750: loss=0.7645 acc=0.8992
Epoch 19 Chunk 0 Step 2000: loss=0.7643 acc=0.8993
Epoch 19 Chunk 2 Step 0: loss=0.7454 acc=0.9033
Epoch 19 Chunk 2 Step 250: loss=0.7594 acc=0.9006
Epoch 19 Chunk 2 Step 500: loss=0.7595 acc=0.9007
Epoch 19 Chunk 2 Step 750: loss=0.7595 acc=0.9006
Epoch 19 Chunk 2 Step 1000: loss=0.7594 acc=0.9006
Epoch 19 Chunk 2 Step 1250: loss=0.7596 acc=0.9005
Epoch 19 Chunk 2 Step 1500: loss=0.7596 acc=0.9005
Epoch 19 Chunk 2 Step 1750: loss=0.7597 acc=0.9004
Epoch 19 Chunk 2 Step 2000: loss=0.7596 acc=0.9004
Epoch 19 Chunk 5 Step 0: loss=0.7167 acc=0.9153
Epoch 19 Chunk 5 Step 250: loss=0.7128 acc=0.9172
Epoch 19 Chunk 5 Step 500: loss=0.7121 acc=0.9174
Epoch 19 Chunk 4 Step 0: loss=0.7635 acc=0.9021
Epoch 19 Chunk 4 Step 250: loss=0.7495 acc=0.9036
Epoch 19 Chunk 4 Step 500: loss=0.7489 acc=0.9040
Epoch 19 Chunk 4 Step 750: loss=0.7488 acc=0.9041
Epoch 19 Chunk 4 Step 1000: loss=0.7487 acc=0.9041
Epoch 19 Chunk 4 Step 1250: loss=0.7488 acc=0.9041
Epoch 19 Chunk 1 Step 0: loss=0.7508 acc=0.9038
Epoch 19 Chunk 1 Step 250: loss=0.7629 acc=0.8994
Epoch 19 Chunk 1 Step 500: loss=0.7620 acc=0.8998
Epoch 19 Chunk 1 Step 750: loss=0.7614 acc=0.9000
Epoch 19 Chunk 1 Step 1000: loss=0.7613 acc=0.9001
Epoch 19 Chunk 1 Step 1250: loss=0.7611 acc=0.9002
Epoch 19 Chunk 1 Step 1500: loss=0.7610 acc=0.9002
Epoch 19 Chunk 1 Step 1750: loss=0.7610 acc=0.9002
Epoch 19 Chunk 1 Step 2000: loss=0.7607 acc=0.9003
Epoch 19 Chunk 3 Step 0: loss=0.7294 acc=0.9097
Epoch 19 Chunk 3 Step 250: loss=0.7528 acc=0.9029
Epoch 19 Chunk 3 Step 500: loss=0.7525 acc=0.9029
Epoch 19 Chunk 3 Step 750: loss=0.7522 acc=0.9030
Epoch 19 Chunk 3 Step 1000: loss=0.7521 acc=0.9030
Epoch 19 Chunk 3 Step 1250: loss=0.7518 acc=0.9031
Epoch 19 Chunk 3 Step 1500: loss=0.7519 acc=0.9031
Epoch 19 Chunk 3 Step 1750: loss=0.7517 acc=0.9031
Epoch 19 | train_loss=0.7549 train_acc=0.9022 | val_loss=0.6963 val_acc=0.9191 val_macro_f1=0.7686
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 20 Chunk 2 Step 0: loss=0.7794 acc=0.8945
Epoch 20 Chunk 2 Step 250: loss=0.7594 acc=0.9000
Epoch 20 Chunk 2 Step 500: loss=0.7587 acc=0.9005
Epoch 20 Chunk 2 Step 750: loss=0.7584 acc=0.9007
Epoch 20 Chunk 2 Step 1000: loss=0.7584 acc=0.9007
Epoch 20 Chunk 2 Step 1250: loss=0.7582 acc=0.9007
Epoch 20 Chunk 2 Step 1500: loss=0.7580 acc=0.9008
Epoch 20 Chunk 2 Step 1750: loss=0.7580 acc=0.9008
Epoch 20 Chunk 2 Step 2000: loss=0.7579 acc=0.9009
Epoch 20 Chunk 5 Step 0: loss=0.7555 acc=0.9077
Epoch 20 Chunk 5 Step 250: loss=0.7124 acc=0.9174
Epoch 20 Chunk 5 Step 500: loss=0.7112 acc=0.9177
Epoch 20 Chunk 3 Step 0: loss=0.7581 acc=0.9026
Epoch 20 Chunk 3 Step 250: loss=0.7517 acc=0.9031
Epoch 20 Chunk 3 Step 500: loss=0.7506 acc=0.9035
Epoch 20 Chunk 3 Step 750: loss=0.7506 acc=0.9034
Epoch 20 Chunk 3 Step 1000: loss=0.7500 acc=0.9035
Epoch 20 Chunk 3 Step 1250: loss=0.7499 acc=0.9035
Epoch 20 Chunk 3 Step 1500: loss=0.7501 acc=0.9035
Epoch 20 Chunk 3 Step 1750: loss=0.7499 acc=0.9035
Epoch 20 Chunk 0 Step 0: loss=0.7587 acc=0.9028
Epoch 20 Chunk 0 Step 250: loss=0.7636 acc=0.8992
Epoch 20 Chunk 0 Step 500: loss=0.7630 acc=0.8994
Epoch 20 Chunk 0 Step 750: loss=0.7630 acc=0.8994
Epoch 20 Chunk 0 Step 1000: loss=0.7626 acc=0.8996
Epoch 20 Chunk 0 Step 1250: loss=0.7627 acc=0.8995
Epoch 20 Chunk 0 Step 1500: loss=0.7628 acc=0.8995
Epoch 20 Chunk 0 Step 1750: loss=0.7626 acc=0.8995
Epoch 20 Chunk 0 Step 2000: loss=0.7624 acc=0.8996
Epoch 20 Chunk 1 Step 0: loss=0.7682 acc=0.8955
Epoch 20 Chunk 1 Step 250: loss=0.7598 acc=0.9008
Epoch 20 Chunk 1 Step 500: loss=0.7588 acc=0.9011
Epoch 20 Chunk 1 Step 750: loss=0.7586 acc=0.9010
Epoch 20 Chunk 1 Step 1000: loss=0.7585 acc=0.9010
Epoch 20 Chunk 1 Step 1250: loss=0.7585 acc=0.9010
Epoch 20 Chunk 1 Step 1500: loss=0.7587 acc=0.9009
Epoch 20 Chunk 1 Step 1750: loss=0.7587 acc=0.9009
Epoch 20 Chunk 1 Step 2000: loss=0.7586 acc=0.9009
Epoch 20 Chunk 4 Step 0: loss=0.7553 acc=0.8989
Epoch 20 Chunk 4 Step 250: loss=0.7474 acc=0.9043
Epoch 20 Chunk 4 Step 500: loss=0.7474 acc=0.9044
Epoch 20 Chunk 4 Step 750: loss=0.7471 acc=0.9045
Epoch 20 Chunk 4 Step 1000: loss=0.7469 acc=0.9046
Epoch 20 Chunk 4 Step 1250: loss=0.7467 acc=0.9046
Epoch 20 | train_loss=0.7531 train_acc=0.9027 | val_loss=0.6942 val_acc=0.9194 val_macro_f1=0.7678
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 21 Chunk 0 Step 0: loss=0.7720 acc=0.8970
Epoch 21 Chunk 0 Step 250: loss=0.7624 acc=0.8994
Epoch 21 Chunk 0 Step 500: loss=0.7617 acc=0.8998
Epoch 21 Chunk 0 Step 750: loss=0.7613 acc=0.8999
Epoch 21 Chunk 0 Step 1000: loss=0.7611 acc=0.9000
Epoch 21 Chunk 0 Step 1250: loss=0.7610 acc=0.9000
Epoch 21 Chunk 0 Step 1500: loss=0.7609 acc=0.9001
Epoch 21 Chunk 0 Step 1750: loss=0.7609 acc=0.9001
Epoch 21 Chunk 0 Step 2000: loss=0.7610 acc=0.9000
Epoch 21 Chunk 4 Step 0: loss=0.7196 acc=0.9133
Epoch 21 Chunk 4 Step 250: loss=0.7457 acc=0.9048
Epoch 21 Chunk 4 Step 500: loss=0.7456 acc=0.9049
Epoch 21 Chunk 4 Step 750: loss=0.7451 acc=0.9051
Epoch 21 Chunk 4 Step 1000: loss=0.7450 acc=0.9051
Epoch 21 Chunk 4 Step 1250: loss=0.7449 acc=0.9051
Epoch 21 Chunk 1 Step 0: loss=0.7647 acc=0.9011
Epoch 21 Chunk 1 Step 250: loss=0.7573 acc=0.9012
Epoch 21 Chunk 1 Step 500: loss=0.7572 acc=0.9013
Epoch 21 Chunk 1 Step 750: loss=0.7572 acc=0.9013
Epoch 21 Chunk 1 Step 1000: loss=0.7571 acc=0.9013
Epoch 21 Chunk 1 Step 1250: loss=0.7571 acc=0.9013
Epoch 21 Chunk 1 Step 1500: loss=0.7572 acc=0.9013
Epoch 21 Chunk 1 Step 1750: loss=0.7572 acc=0.9013
Epoch 21 Chunk 1 Step 2000: loss=0.7571 acc=0.9013
Epoch 21 Chunk 2 Step 0: loss=0.7602 acc=0.9038
Epoch 21 Chunk 2 Step 250: loss=0.7579 acc=0.9008
Epoch 21 Chunk 2 Step 500: loss=0.7570 acc=0.9011
Epoch 21 Chunk 2 Step 750: loss=0.7564 acc=0.9013
Epoch 21 Chunk 2 Step 1000: loss=0.7563 acc=0.9014
Epoch 21 Chunk 2 Step 1250: loss=0.7565 acc=0.9013
Epoch 21 Chunk 2 Step 1500: loss=0.7563 acc=0.9013
Epoch 21 Chunk 2 Step 1750: loss=0.7564 acc=0.9013
Epoch 21 Chunk 2 Step 2000: loss=0.7564 acc=0.9013
Epoch 21 Chunk 5 Step 0: loss=0.7164 acc=0.9170
Epoch 21 Chunk 5 Step 250: loss=0.7115 acc=0.9177
Epoch 21 Chunk 5 Step 500: loss=0.7101 acc=0.9180
Epoch 21 Chunk 3 Step 0: loss=0.7611 acc=0.9019
Epoch 21 Chunk 3 Step 250: loss=0.7507 acc=0.9034
Epoch 21 Chunk 3 Step 500: loss=0.7494 acc=0.9037
Epoch 21 Chunk 3 Step 750: loss=0.7493 acc=0.9037
Epoch 21 Chunk 3 Step 1000: loss=0.7488 acc=0.9038
Epoch 21 Chunk 3 Step 1250: loss=0.7489 acc=0.9038
Epoch 21 Chunk 3 Step 1500: loss=0.7487 acc=0.9039
Epoch 21 Chunk 3 Step 1750: loss=0.7486 acc=0.9039
Epoch 21 | train_loss=0.7516 train_acc=0.9031 | val_loss=0.6930 val_acc=0.9200 val_macro_f1=0.7693
Saved checkpoint: artifacts/cnn_ddp/checkpoint_best.pt
Epoch 22 Chunk 1 Step 0: loss=0.7298 acc=0.9084
Epoch 22 Chunk 1 Step 250: loss=0.7558 acc=0.9015
Epoch 22 Chunk 1 Step 500: loss=0.7558 acc=0.9016
